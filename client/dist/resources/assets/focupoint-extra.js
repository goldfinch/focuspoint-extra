(function(c){c.entwine("ss",function(t){t(".cms-edit-form").entwine({onadd:function(){t(".image-coord-field .grid").each(function(e,i){t(i).closest(".ui-accordion").length&&t(i).closest(".ui-accordion").find(".ui-accordion-header").click(()=>{t(this).updateGrid()})}),this._super()}});function l(){t(".image-coord-field .grid").each(function(){t(this).updateGrid()})}t(window).on("resize",l),t(".image-coord-field .grid").entwine({onmatch:function(){var e=this;setTimeout(function(){e.updateGrid()},1200)},getCoordField:function(e){var i=e.toUpperCase()==="Y"?this.data("yFieldName"):this.data("xFieldName"),d="input[name='"+i+"']";return this.closest(".image-coord-fieldgroup").find(d)},roundXYValues:function(e){return e.toFixed(4)},updateGrid:function(){let e=t(".ss-gridfield-item .image-coord-field");e.length&&e.closest("td").addClass("imagecoord image-coord-fieldgroup");var i=t(this),d=i.getCoordField("x").val(),a=i.getCoordField("y").val(),f=11,o=Math.floor(-f/2),s=i.width(),r=i.height(),n=this.data("cssGrid")?o+d*s:o+(d/2+.5)*s,u=this.data("cssGrid")?o+a*r:o+(-a/2+.5)*r;i.css("background-position",n+"px "+u+"px"),i.find(".fpaim").css({left:Math.round((Number(d)+1)*.5*s),top:Math.round((Number(a)+1)*.5*r),width:s*2,height:r*2})},onclick:function(e){var i=t(this),d=i.width(),a=i.height(),f=e.pageX-i.offset().left,o=e.pageY-i.offset().top,s=this.data("cssGrid")?f/d:(f/d-.5)*2,r=this.data("cssGrid")?o/a:(o/a-.5)*2;this.getCoordField("x").val(s),this.getCoordField("y").val(r),this.updateGrid(),t(this).closest("form").addClass("changed")},onmousemove:function(e){var i=t(this),d=i.width(),a=i.height(),f=e.pageX-i.offset().left,o=e.pageY-i.offset().top,s=this.data("cssGrid")?f/d:(f/d-.5)*2,r=this.data("cssGrid")?o/a:(o/a-.5)*-2,n=this.closest(".image-coord-fieldgroup").find(".sumField");n.html("mouseX "+this.roundXYValues(s)+" / mouseY "+this.roundXYValues(r))}})})})(jQuery);
