(function(c){c.entwine("ss",function(s){console.log("init");function u(){s(".image-coord-field .grid").each(function(){s(this).updateGrid()})}s(window).on("resize",u),s(".image-coord-field .grid").entwine({onmatch:function(){var e=this;setTimeout(function(){e.updateGrid()},1200)},getCoordField:function(e){var i=e.toUpperCase()==="Y"?this.data("yFieldName"):this.data("xFieldName"),o="input[name='"+i+"']";return console.log("LOOK FOR:",i),this.closest(".image-coord-fieldgroup").find(o)},roundXYValues:function(e){return e.toFixed(4)},updateGrid:function(){let e=s(".ss-gridfield-item .image-coord-field");e.length&&e.closest("td").addClass("imagecoord image-coord-fieldgroup");var i=s(this),o=i.getCoordField("x").val(),d=i.getCoordField("y").val();console.log("grid",o,d,i);var a=11,t=Math.floor(-a/2),r=i.width(),l=i.height(),f=this.data("cssGrid")?t+o*r:t+(o/2+.5)*r,n=this.data("cssGrid")?t+d*l:t+(-d/2+.5)*l;console.log(f,n),i.css("background-position",f+"px "+n+"px")},onclick:function(e){var i=s(this),o=i.width(),d=i.height(),a=e.pageX-i.offset().left,t=e.pageY-i.offset().top,r=this.data("cssGrid")?a/o:(a/o-.5)*2,l=this.data("cssGrid")?t/d:(t/d-.5)*-2;console.log("click",this.roundXYValues(r),this.roundXYValues(l)),this.getCoordField("x").val(this.roundXYValues(r)),this.getCoordField("y").val(this.roundXYValues(l)),console.log("check",this.getCoordField("x").val(),this.getCoordField("y").val()),this.updateGrid(),s(this).closest("form").addClass("changed")},onmousemove:function(e){var i=s(this),o=i.width(),d=i.height(),a=e.pageX-i.offset().left,t=e.pageY-i.offset().top,r=this.data("cssGrid")?a/o:(a/o-.5)*2,l=this.data("cssGrid")?t/d:(t/d-.5)*-2,f=this.closest(".image-coord-fieldgroup").find(".sumField");f.html("mouseX "+this.roundXYValues(r)+" / mouseY "+this.roundXYValues(l))}})})})(jQuery);
