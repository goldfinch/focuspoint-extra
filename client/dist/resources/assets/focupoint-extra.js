(function(l){l.entwine("ss",function(e){e(".cms-edit-form").entwine({onadd:function(){e(".image-coord-field .grid").each(function(t,i){e(i).closest(".ui-accordion").length&&e(i).closest(".ui-accordion").find(".ui-accordion-header").click(()=>{e(this).updateGrid()})}),this._super()},onchange:function(){e(".uploadfield-item__remove-btn").off("click").click(t=>{let i=e(t.currentTarget).closest(".entwine-uploadfield.uploadfield").find("input");if(i.length){let o=i.attr("name").split("[")[0],d=e('input[name="'+o+'-_1_-FocusPointX"]');d.length&&d.closest(".CompositeField.togglecomposite").remove()}})}});function c(){e(".image-coord-field .grid").each(function(){e(this).updateGrid()})}e(window).on("resize",c),e(".image-coord-field .grid").entwine({onmatch:function(){var t=this;setTimeout(function(){t.updateGrid()},200)},getCoordField:function(t){var i=t.toUpperCase()==="Y"?this.data("yFieldName"):this.data("xFieldName"),o="input[name='"+i+"']";return this.closest(".image-coord-fieldgroup").find(o)},roundXYValues:function(t){return t.toFixed(4)},updateGrid:function(){let t=e(".ss-gridfield-item .image-coord-field");t.length&&t.closest("td").addClass("imagecoord image-coord-fieldgroup");var i=e(this),o=i.getCoordField("x").val(),d=i.getCoordField("y").val(),n=11,a=Math.floor(-n/2),s=i.width(),r=i.height(),f=this.data("cssGrid")?a+o*s:a+(o/2+.5)*s,u=this.data("cssGrid")?a+d*r:a+(-d/2+.5)*r;i.css("background-position",f+"px "+u+"px"),i.find(".fpaim").css({left:Math.round((Number(o)+1)*.5*s),top:Math.round((Number(d)+1)*.5*r),width:s*2,height:r*2})},onclick:function(t){var i=e(this),o=i.width(),d=i.height(),n=t.pageX-i.offset().left,a=t.pageY-i.offset().top,s=this.data("cssGrid")?n/o:(n/o-.5)*2,r=this.data("cssGrid")?a/d:(a/d-.5)*2;this.getCoordField("x").val(s),this.getCoordField("y").val(r),this.updateGrid(),e(this).closest("form").addClass("changed")},onmousemove:function(t){var i=e(this),o=i.width(),d=i.height(),n=t.pageX-i.offset().left,a=t.pageY-i.offset().top,s=this.data("cssGrid")?n/o:(n/o-.5)*2,r=this.data("cssGrid")?a/d:(a/d-.5)*-2,f=this.closest(".image-coord-fieldgroup").find(".sumField");f.html("mouseX "+this.roundXYValues(s)+" / mouseY "+this.roundXYValues(r))}})})})(jQuery);
